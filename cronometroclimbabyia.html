<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronômetro Climba</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f5f5f5;
            flex-direction: column;
            margin: 0;
            transition: background-color 0.5s, color 0.5s;
        }
        .container {
            text-align: center;
            width: 100%;
            padding: 0 20px;
        }
        .title {
            font-size: 2.5rem; /* Tamanho original */
            margin-bottom: 1rem;
            color: #151634;
            transition: color 0.5s;
        }
        .time {
            font-size: 15vw; /* Texto de tempo proporcional à largura da tela */
            margin-bottom: 1rem;
            color: #151634;
            transition: color 0.5s;
        }
        .time-out {
            color: red;
            font-size: 5vw; /* Texto de aviso proporcional à largura da tela */
            animation: blink 1s step-start infinite;
        }
        @keyframes blink {
            50% {
                opacity: 0;
            }
        }
        .progress-container {
            margin: 20px 0;
        }
        .predefined-buttons button {
            margin: 5px;
            background-color: #e0e0e0;
            color: #151634;
            transition: background-color 0.5s, color 0.5s;
        }
        .btn-primary {
            background-color: #151634 !important;
            color: #fff !important;
            transition: background-color 0.5s, color 0.5s;
        }
        .btn-secondary {
            background-color: #74DC3B !important;
            color: #151634;
            transition: background-color 0.5s, color 0.5s;
        }
        .fullscreen-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 2rem;
            color: #151634;
            transition: color 0.5s;
        }
        .hidden {
            display: none;
        }
        .input-field {
            margin: 10px 0;
        }
        label {
            font-size: 1.5rem;
            color: #151634;
            transition: color 0.5s;
        }
        input[type="number"] {
            font-size: 2rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <button class="fullscreen-button" id="fullscreenButton">
        <i class="material-icons">fullscreen</i>
    </button>
    <div class="container">
        <div class="title" id="title">Cronômetro Climba by IA</div>
        <div id="controlPanel">
            <div class="input-field inline">
                <label for="hours">Horas</label>
                <input id="hours" type="number" min="0" value="0" placeholder="HH">
            </div>
            <div class="input-field inline">
                <label for="minutes">Minutos</label>
                <input id="minutes" type="number" min="0" value="0" placeholder="MM">
            </div>
            <div class="input-field inline">
                <label for="seconds">Segundos</label>
                <input id="seconds" type="number" min="0" value="0" placeholder="SS">
            </div>
            <button id="startButton" class="btn waves-effect waves-light btn-primary">Iniciar</button>
            <div class="predefined-buttons">
                <button class="btn predefined-time" data-time="120">2 minutos</button>
                <button class="btn predefined-time" data-time="480">8 minutos</button>
                <button class="btn predefined-time" data-time="900">15 minutos</button>
                <button class="btn predefined-time" data-time="1800">30 minutos</button>
                <button class="btn predefined-time" data-time="3600">1 hora</button>
            </div>
        </div>
        <div class="progress-container hidden">
            <div class="progress">
                <div id="progressBar" class="determinate" style="width: 0%;"></div>
            </div>
        </div>
        <div class="time hidden" id="timeDisplay">00:00:00</div>
        <div class="time-out hidden" id="timeOutDisplay"></div>
        <button id="resetButton" class="btn waves-effect waves-light btn-secondary hidden">Parar</button>
    </div>
    <audio id="alertSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        let timer;
        let endTime;
        let totalMilliseconds;
        let isTimeOut = false;
        let alertInterval;

        document.getElementById('startButton').addEventListener('click', function () {
            const hours = parseInt(document.getElementById('hours').value) || 0;
            const minutes = parseInt(document.getElementById('minutes').value) || 0;
            const seconds = parseInt(document.getElementById('seconds').value) || 0;
            totalMilliseconds = (hours * 3600 + minutes * 60 + seconds) * 1000;

            if (totalMilliseconds > 0) {
                startTimer(totalMilliseconds);
            }
        });

        document.getElementById('resetButton').addEventListener('click', function () {
            clearInterval(timer);
            clearInterval(alertInterval);
            document.getElementById('timeDisplay').textContent = '00:00:00';
            document.getElementById('timeOutDisplay').textContent = '';
            document.getElementById('progressBar').style.width = '0%';
            document.body.style.backgroundColor = '#f5f5f5';
            document.body.style.color = '#151634';
            document.getElementById('title').style.color = '#151634';
            document.getElementById('timeDisplay').style.color = '#151634';
            const labels = document.querySelectorAll('label');
            labels.forEach(label => label.style.color = '#151634');
            isTimeOut = false;
            toggleElements(true);
        });

        document.querySelectorAll('.predefined-time').forEach(button => {
            button.addEventListener('click', function () {
                const time = parseInt(this.getAttribute('data-time'));
                const hours = Math.floor(time / 3600);
                const minutes = Math.floor((time % 3600) / 60);
                const seconds = time % 60;

                document.getElementById('hours').value = hours;
                document.getElementById('minutes').value = minutes;
                document.getElementById('seconds').value = seconds;
            });
        });

        document.getElementById('fullscreenButton').addEventListener('click', function () {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        });

        function startTimer(duration) {
            clearInterval(timer);
            clearInterval(alertInterval);
            isTimeOut = false;
            endTime = Date.now() + duration;
            document.getElementById('timeOutDisplay').textContent = '';
            timer = setInterval(updateTimer, 1000);
            toggleElements(false);
        }

        function updateTimer() {
            const remainingTime = Math.max(0, endTime - Date.now());
            const seconds = Math.floor(remainingTime / 1000) % 60;
            const minutes = Math.floor(remainingTime / (1000 * 60)) % 60;
            const hours = Math.floor(remainingTime / (1000 * 60 * 60));

            document.getElementById('timeDisplay').textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

            const progress = ((totalMilliseconds - remainingTime) / totalMilliseconds) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            if (remainingTime === 0 && !isTimeOut) {
                isTimeOut = true;
                document.getElementById('timeOutDisplay').innerHTML = '⏰ TEMPO ESGOTADO ⏰';
                document.body.style.backgroundColor = '#151634'; // Azul marinho
                document.body.style.color = '#ffffff'; // Branco
                document.getElementById('title').style.color = '#ffffff'; // Branco
                document.getElementById('timeDisplay').style.color = '#ffffff'; // Branco
                const labels = document.querySelectorAll('label');
                labels.forEach(label => label.style.color = '#ffffff'); // Branco
                playAlertSound();
                endTime = Date.now();
                alertInterval = setInterval(playAlertSound, 300000); // Toca a cada 5 minutos
            }

            if (isTimeOut) {
                const elapsedTime = Date.now() - endTime;
                const elapsedSeconds = Math.floor(elapsedTime / 1000) % 60;
                const elapsedMinutes = Math.floor(elapsedTime / (1000 * 60)) % 60;
                const elapsedHours = Math.floor(elapsedTime / (1000 * 60 * 60));

                document.getElementById('timeDisplay').textContent = `+${String(elapsedHours).padStart(2, '0')}:${String(elapsedMinutes).padStart(2, '0')}:${String(elapsedSeconds).padStart(2, '0')}`;
            }
        }

        function playAlertSound() {
            const alertSound = document.getElementById('alertSound');
            alertSound.play();
        }

        function toggleElements(show) {
            document.getElementById('controlPanel').classList.toggle('hidden', !show);
            document.getElementById('resetButton').classList.toggle('hidden', show);
            document.getElementById('progressBar').parentElement.parentElement.classList.toggle('hidden', show);
            document.getElementById('timeDisplay').classList.toggle('hidden', show);
            document.getElementById('timeOutDisplay').classList.toggle('hidden', show);
        }
    </script>
</body>
</html>
